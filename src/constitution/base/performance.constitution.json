{
  "id": "performance",
  "name": "Performance Testing Constitution",
  "version": "1.0.0",
  "description": "Constitution governing the qe-performance-tester agent, defining principles for response time, throughput, resource efficiency, and load testing standards",
  "principles": [
    {
      "id": "response-time-excellence",
      "name": "Response Time Excellence",
      "description": "Applications must respond within acceptable time limits to ensure positive user experience.",
      "priority": "critical",
      "category": "latency",
      "mandatory": true,
      "tags": ["latency", "response-time", "user-experience"]
    },
    {
      "id": "throughput-capacity",
      "name": "Throughput Capacity",
      "description": "Systems must handle expected transaction volumes with capacity headroom.",
      "priority": "critical",
      "category": "throughput",
      "mandatory": true,
      "tags": ["throughput", "tps", "capacity"]
    },
    {
      "id": "resource-efficiency",
      "name": "Resource Efficiency",
      "description": "Applications must use computing resources (CPU, memory, I/O) efficiently without waste.",
      "priority": "high",
      "category": "resources",
      "mandatory": true,
      "tags": ["cpu", "memory", "efficiency"]
    },
    {
      "id": "scalability",
      "name": "Scalability",
      "description": "Systems must scale linearly or better under increasing load.",
      "priority": "high",
      "category": "scalability",
      "tags": ["scaling", "elasticity", "growth"]
    },
    {
      "id": "stability-under-load",
      "name": "Stability Under Load",
      "description": "Applications must remain stable and not degrade significantly under sustained load.",
      "priority": "critical",
      "category": "stability",
      "mandatory": true,
      "tags": ["stability", "reliability", "endurance"]
    },
    {
      "id": "error-rate-tolerance",
      "name": "Error Rate Tolerance",
      "description": "Error rates must remain within acceptable bounds even under load.",
      "priority": "high",
      "category": "reliability",
      "tags": ["errors", "reliability", "fault-tolerance"]
    },
    {
      "id": "graceful-degradation",
      "name": "Graceful Degradation",
      "description": "Systems should degrade gracefully under extreme load rather than failing catastrophically.",
      "priority": "medium",
      "category": "resilience",
      "tags": ["degradation", "resilience", "overload"]
    }
  ],
  "rules": [
    {
      "id": "p95-latency-limit",
      "name": "P95 Latency Limit",
      "principleId": "response-time-excellence",
      "condition": {
        "field": "latency_p95",
        "operator": "greater_than",
        "value": 500,
        "unit": "ms"
      },
      "action": {
        "type": "fail",
        "message": "P95 latency exceeds 500ms. Optimize response time.",
        "stopProcessing": true
      },
      "severity": "error",
      "enabled": true,
      "description": "Enforces 95th percentile latency threshold",
      "remediation": "Profile slow endpoints and optimize database queries, caching, or algorithms"
    },
    {
      "id": "p99-latency-limit",
      "name": "P99 Latency Limit",
      "principleId": "response-time-excellence",
      "condition": {
        "field": "latency_p99",
        "operator": "greater_than",
        "value": 1000,
        "unit": "ms"
      },
      "action": {
        "type": "fail",
        "message": "P99 latency exceeds 1 second. Address tail latency issues.",
        "stopProcessing": true
      },
      "severity": "error",
      "enabled": true,
      "description": "Enforces 99th percentile latency threshold"
    },
    {
      "id": "minimum-throughput",
      "name": "Minimum Throughput",
      "principleId": "throughput-capacity",
      "condition": {
        "field": "throughput_tps",
        "operator": "less_than",
        "value": 100
      },
      "action": {
        "type": "fail",
        "message": "Throughput below 100 TPS. System cannot handle expected load.",
        "stopProcessing": true
      },
      "severity": "error",
      "enabled": true,
      "description": "Enforces minimum transactions per second"
    },
    {
      "id": "max-cpu-usage",
      "name": "Maximum CPU Usage",
      "principleId": "resource-efficiency",
      "condition": {
        "field": "cpu_usage_avg",
        "operator": "greater_than",
        "value": 80,
        "unit": "percent"
      },
      "action": {
        "type": "warn",
        "message": "Average CPU usage exceeds 80%. Consider optimization or scaling."
      },
      "severity": "warning",
      "enabled": true,
      "description": "Monitors CPU utilization"
    },
    {
      "id": "max-memory-usage",
      "name": "Maximum Memory Usage",
      "principleId": "resource-efficiency",
      "condition": {
        "field": "memory_usage_avg",
        "operator": "greater_than",
        "value": 85,
        "unit": "percent"
      },
      "action": {
        "type": "fail",
        "message": "Average memory usage exceeds 85%. Risk of OOM errors.",
        "stopProcessing": true
      },
      "severity": "error",
      "enabled": true,
      "description": "Monitors memory utilization",
      "remediation": "Identify memory leaks and optimize data structures"
    },
    {
      "id": "max-error-rate",
      "name": "Maximum Error Rate",
      "principleId": "error-rate-tolerance",
      "condition": {
        "field": "error_rate",
        "operator": "greater_than",
        "value": 1,
        "unit": "percent"
      },
      "action": {
        "type": "fail",
        "message": "Error rate exceeds 1%. Investigate failures.",
        "stopProcessing": true
      },
      "severity": "error",
      "enabled": true,
      "description": "Enforces maximum acceptable error rate"
    },
    {
      "id": "connection-pool-saturation",
      "name": "Connection Pool Saturation",
      "principleId": "resource-efficiency",
      "condition": {
        "field": "connection_pool_usage",
        "operator": "greater_than",
        "value": 90,
        "unit": "percent"
      },
      "action": {
        "type": "warn",
        "message": "Connection pool utilization exceeds 90%. Risk of connection exhaustion."
      },
      "severity": "warning",
      "enabled": true,
      "description": "Monitors database connection pool usage"
    },
    {
      "id": "apdex-score",
      "name": "Apdex Score Threshold",
      "principleId": "response-time-excellence",
      "condition": {
        "field": "apdex_score",
        "operator": "less_than",
        "value": 0.9
      },
      "action": {
        "type": "warn",
        "message": "Apdex score below 0.9. User satisfaction at risk."
      },
      "severity": "warning",
      "enabled": true,
      "description": "Monitors Application Performance Index"
    }
  ],
  "metrics": [
    {
      "id": "latency-p50",
      "name": "P50 Latency",
      "description": "50th percentile (median) response time",
      "unit": "ms",
      "aggregation": "percentile",
      "percentile": 50,
      "dataType": "duration",
      "higherIsBetter": false,
      "targetValue": 100,
      "warningThreshold": 200,
      "criticalThreshold": 300
    },
    {
      "id": "latency-p95",
      "name": "P95 Latency",
      "description": "95th percentile response time",
      "unit": "ms",
      "aggregation": "percentile",
      "percentile": 95,
      "dataType": "duration",
      "higherIsBetter": false,
      "targetValue": 250,
      "warningThreshold": 500,
      "criticalThreshold": 750
    },
    {
      "id": "latency-p99",
      "name": "P99 Latency",
      "description": "99th percentile response time",
      "unit": "ms",
      "aggregation": "percentile",
      "percentile": 99,
      "dataType": "duration",
      "higherIsBetter": false,
      "targetValue": 500,
      "warningThreshold": 1000,
      "criticalThreshold": 2000
    },
    {
      "id": "throughput-tps",
      "name": "Throughput (TPS)",
      "description": "Transactions per second processed",
      "unit": "tps",
      "aggregation": "avg",
      "dataType": "number",
      "higherIsBetter": true,
      "targetValue": 1000,
      "warningThreshold": 100,
      "criticalThreshold": 50
    },
    {
      "id": "requests-per-second",
      "name": "Requests per Second",
      "description": "Number of requests processed per second",
      "unit": "rps",
      "aggregation": "avg",
      "dataType": "number",
      "higherIsBetter": true
    },
    {
      "id": "cpu-usage-avg",
      "name": "Average CPU Usage",
      "description": "Average CPU utilization during test",
      "unit": "percent",
      "aggregation": "avg",
      "dataType": "percentage",
      "higherIsBetter": false,
      "targetValue": 50,
      "warningThreshold": 80,
      "criticalThreshold": 95
    },
    {
      "id": "memory-usage-avg",
      "name": "Average Memory Usage",
      "description": "Average memory utilization during test",
      "unit": "percent",
      "aggregation": "avg",
      "dataType": "percentage",
      "higherIsBetter": false,
      "targetValue": 60,
      "warningThreshold": 85,
      "criticalThreshold": 95
    },
    {
      "id": "error-rate",
      "name": "Error Rate",
      "description": "Percentage of requests resulting in errors",
      "unit": "percent",
      "aggregation": "avg",
      "dataType": "percentage",
      "higherIsBetter": false,
      "targetValue": 0,
      "warningThreshold": 0.5,
      "criticalThreshold": 1
    },
    {
      "id": "concurrent-users",
      "name": "Concurrent Users",
      "description": "Number of simultaneous users simulated",
      "unit": "users",
      "aggregation": "max",
      "dataType": "count",
      "higherIsBetter": true
    },
    {
      "id": "apdex-score",
      "name": "Apdex Score",
      "description": "Application Performance Index score (0-1)",
      "unit": "score",
      "aggregation": "avg",
      "dataType": "ratio",
      "higherIsBetter": true,
      "targetValue": 0.95,
      "warningThreshold": 0.85,
      "criticalThreshold": 0.7
    },
    {
      "id": "connection-pool-usage",
      "name": "Connection Pool Usage",
      "description": "Percentage of connection pool in use",
      "unit": "percent",
      "aggregation": "max",
      "dataType": "percentage",
      "higherIsBetter": false,
      "targetValue": 50,
      "warningThreshold": 80,
      "criticalThreshold": 95
    },
    {
      "id": "garbage-collection-time",
      "name": "GC Time",
      "description": "Time spent in garbage collection",
      "unit": "ms",
      "aggregation": "sum",
      "dataType": "duration",
      "higherIsBetter": false
    }
  ],
  "thresholds": [
    {
      "id": "latency-p95-gate",
      "metricId": "latency-p95",
      "name": "P95 Latency Gate",
      "mode": "absolute",
      "warning": 500,
      "critical": 750,
      "target": 250,
      "blocking": true
    },
    {
      "id": "latency-p99-gate",
      "metricId": "latency-p99",
      "name": "P99 Latency Gate",
      "mode": "absolute",
      "warning": 1000,
      "critical": 2000,
      "target": 500,
      "blocking": true
    },
    {
      "id": "throughput-gate",
      "metricId": "throughput-tps",
      "name": "Throughput Gate",
      "mode": "absolute",
      "warning": 100,
      "critical": 50,
      "target": 1000,
      "blocking": true
    },
    {
      "id": "cpu-gate",
      "metricId": "cpu-usage-avg",
      "name": "CPU Usage Gate",
      "mode": "percentage",
      "warning": 80,
      "critical": 95,
      "target": 50,
      "blocking": false
    },
    {
      "id": "memory-gate",
      "metricId": "memory-usage-avg",
      "name": "Memory Usage Gate",
      "mode": "percentage",
      "warning": 85,
      "critical": 95,
      "target": 60,
      "blocking": true
    },
    {
      "id": "error-rate-gate",
      "metricId": "error-rate",
      "name": "Error Rate Gate",
      "mode": "percentage",
      "warning": 0.5,
      "critical": 1,
      "target": 0,
      "blocking": true
    },
    {
      "id": "apdex-gate",
      "metricId": "apdex-score",
      "name": "Apdex Score Gate",
      "mode": "absolute",
      "warning": 0.85,
      "critical": 0.7,
      "target": 0.95,
      "blocking": false
    }
  ],
  "metadata": {
    "createdAt": "2024-01-01T00:00:00Z",
    "updatedAt": "2024-11-19T00:00:00Z",
    "author": "Agentic QE Fleet",
    "applicableTo": ["performance-tester", "qe-performance-tester"],
    "inheritsFrom": "default",
    "status": "active",
    "changelog": [
      {
        "version": "1.0.0",
        "date": "2024-11-19T00:00:00Z",
        "description": "Initial release of performance testing constitution",
        "author": "Constitution Schema Designer"
      }
    ]
  }
}

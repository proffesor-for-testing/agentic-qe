{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Testability Report",
  "description": "Schema for testability assessment reports",
  "type": "object",
  "required": ["timestamp", "overall", "principles", "metadata"],
  "properties": {
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Assessment execution timestamp"
    },
    "overall": {
      "type": "number",
      "minimum": 0,
      "maximum": 100,
      "description": "Overall weighted testability score"
    },
    "grade": {
      "type": "string",
      "enum": ["A", "B", "C", "D", "F"],
      "description": "Letter grade for overall score"
    },
    "principles": {
      "type": "object",
      "description": "Individual principle scores",
      "properties": {
        "observability": {
          "$ref": "#/definitions/principleScore"
        },
        "controllability": {
          "$ref": "#/definitions/principleScore"
        },
        "algorithmicSimplicity": {
          "$ref": "#/definitions/principleScore"
        },
        "algorithmicTransparency": {
          "$ref": "#/definitions/principleScore"
        },
        "explainability": {
          "$ref": "#/definitions/principleScore"
        },
        "similarity": {
          "$ref": "#/definitions/principleScore"
        },
        "algorithmicStability": {
          "$ref": "#/definitions/principleScore"
        },
        "unbugginess": {
          "$ref": "#/definitions/principleScore"
        },
        "smallness": {
          "$ref": "#/definitions/principleScore"
        },
        "decomposability": {
          "$ref": "#/definitions/principleScore"
        }
      },
      "required": [
        "observability",
        "controllability",
        "algorithmicSimplicity",
        "algorithmicTransparency",
        "explainability",
        "similarity",
        "algorithmicStability",
        "unbugginess",
        "smallness",
        "decomposability"
      ]
    },
    "recommendations": {
      "type": "array",
      "description": "AI-generated improvement recommendations",
      "items": {
        "$ref": "#/definitions/recommendation"
      }
    },
    "metadata": {
      "type": "object",
      "description": "Assessment metadata",
      "properties": {
        "url": {
          "type": "string",
          "format": "uri",
          "description": "Application URL"
        },
        "browser": {
          "type": "string",
          "enum": ["chromium", "firefox", "webkit"],
          "description": "Browser used for testing"
        },
        "duration": {
          "type": "number",
          "description": "Assessment duration in milliseconds"
        },
        "version": {
          "type": "string",
          "description": "Testability scorer version"
        },
        "userType": {
          "type": "string",
          "description": "User type tested (if applicable)"
        }
      },
      "required": ["url", "browser", "duration", "version"]
    },
    "history": {
      "type": "array",
      "description": "Historical comparison data",
      "items": {
        "type": "object",
        "properties": {
          "timestamp": {
            "type": "string",
            "format": "date-time"
          },
          "overall": {
            "type": "number",
            "minimum": 0,
            "maximum": 100
          }
        }
      }
    }
  },
  "definitions": {
    "principleScore": {
      "type": "object",
      "required": ["score", "grade"],
      "properties": {
        "score": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Numerical score for this principle"
        },
        "grade": {
          "type": "string",
          "enum": ["A", "B", "C", "D", "F"],
          "description": "Letter grade"
        },
        "weight": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Weight percentage in overall score"
        },
        "measurements": {
          "type": "object",
          "description": "Detailed measurements for this principle",
          "additionalProperties": true
        }
      }
    },
    "recommendation": {
      "type": "object",
      "required": ["principle", "severity", "recommendation"],
      "properties": {
        "principle": {
          "type": "string",
          "description": "Principle this recommendation addresses"
        },
        "severity": {
          "type": "string",
          "enum": ["low", "medium", "high", "critical"],
          "description": "Severity/priority level"
        },
        "recommendation": {
          "type": "string",
          "description": "Improvement recommendation text"
        },
        "effort": {
          "type": "string",
          "enum": ["low", "medium", "high"],
          "description": "Estimated implementation effort"
        },
        "impact": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Expected score improvement"
        },
        "examples": {
          "type": "array",
          "description": "Code examples or implementation guidance",
          "items": {
            "type": "string"
          }
        }
      }
    }
  }
}

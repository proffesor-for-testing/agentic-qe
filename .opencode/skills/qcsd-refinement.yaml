name: qcsd-refinement
description: "QCSD Refinement phase — Sprint Refinement with SFDIPOT product factors, BDD scenario generation, and requirements validation."
minModelTier: tier3-best
tags: ["qcsd", "swarm", "quality-engineering", "refinement"]
steps:
  - name: product-factor-analysis
    description: "Apply SFDIPOT product factor analysis to identify quality dimensions for each story."
    tools: ["task", "mcp:agentic-qe:requirements_validate", "mcp:agentic-qe:memory_query"]
    prompt: |
      Spawn parallel agents for product factor analysis:
      1. qe-product-factors-assessor — Apply SFDIPOT framework to user stories
      2. qe-requirements-validator — Validate requirements completeness and testability
      Consume Ideation Report from memory for context continuity.

  - name: bdd-scenario-generation
    description: "Generate BDD scenarios in Gherkin syntax for each refined user story."
    tools: ["task", "mcp:agentic-qe:test_generate_enhanced", "mcp:agentic-qe:memory_store"]
    prompt: |
      For each user story:
      1. Generate Given/When/Then BDD scenarios covering happy path, edge cases, and error paths
      2. Map scenarios to SFDIPOT quality dimensions
      3. Identify cross-story dependencies and shared test fixtures
      Store scenarios in memory for Development phase consumption.

  - name: refinement-synthesis
    description: "Produce a Refinement Report with acceptance criteria, BDD scenarios, and test strategy."
    tools: ["mcp:agentic-qe:memory_store", "mcp:agentic-qe:quality_assess"]
    prompt: |
      Synthesize product factors, requirements validation, and BDD scenarios into:
      - Acceptance criteria per story
      - Complete BDD scenario inventory
      - Estimated test effort and coverage targets
      Store for Development phase consumption.

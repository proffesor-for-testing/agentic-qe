{
  "$schema": "./router.config.schema.json",
  "_comment": "ADR-043: LLM Router Configuration Example - All options documented",

  "mode": "rule-based",
  "_mode_options": ["manual", "rule-based", "cost-optimized", "performance-optimized"],

  "defaultProvider": "claude",
  "defaultModel": "claude-sonnet-4-20250514",

  "providers": {
    "claude": {
      "enabled": true,
      "apiKey": "${ANTHROPIC_API_KEY}",
      "defaultModel": "claude-sonnet-4-20250514",
      "timeoutMs": 30000,
      "maxRetries": 2,
      "rateLimit": {
        "requestsPerMinute": 60,
        "tokensPerMinute": 100000
      }
    },
    "openai": {
      "enabled": true,
      "apiKey": "${OPENAI_API_KEY}",
      "defaultModel": "gpt-4o",
      "timeoutMs": 30000,
      "maxRetries": 2
    },
    "ollama": {
      "enabled": true,
      "baseUrl": "http://localhost:11434",
      "defaultModel": "llama3.1",
      "timeoutMs": 60000
    },
    "openrouter": {
      "enabled": false,
      "apiKey": "${OPENROUTER_API_KEY}",
      "defaultModel": "anthropic/claude-sonnet-4"
    },
    "gemini": {
      "enabled": false,
      "apiKey": "${GOOGLE_API_KEY}",
      "defaultModel": "gemini-2.0-pro"
    },
    "azure-openai": {
      "enabled": false,
      "apiKey": "${AZURE_OPENAI_API_KEY}",
      "baseUrl": "${AZURE_OPENAI_ENDPOINT}",
      "defaultModel": "gpt-4o"
    },
    "bedrock": {
      "enabled": false,
      "_comment": "Uses AWS credentials from environment"
    },
    "onnx": {
      "enabled": true,
      "defaultModel": "phi-4",
      "_comment": "Local ONNX runtime - no API key needed"
    }
  },

  "rules": [
    {
      "id": "security-tasks",
      "name": "Security Tasks",
      "description": "Route security-related tasks to advanced models",
      "condition": {
        "agentType": ["security-auditor", "security-architect"],
        "complexity": ["high", "expert"]
      },
      "action": {
        "provider": "claude",
        "model": "claude-sonnet-4-20250514",
        "temperature": 0.2
      },
      "enabled": true,
      "priority": 100
    },
    {
      "id": "simple-tasks",
      "name": "Simple Tasks",
      "description": "Route trivial tasks to efficient models",
      "condition": {
        "complexity": ["trivial", "low"],
        "tokenRange": { "max": 1000 }
      },
      "action": {
        "provider": "openai",
        "model": "gpt-4o-mini"
      },
      "enabled": true,
      "priority": 90
    },
    {
      "id": "local-only",
      "name": "Local Only Tasks",
      "description": "Route privacy-sensitive tasks to local models",
      "condition": {
        "localOnly": true
      },
      "action": {
        "provider": "ollama",
        "model": "llama3.1"
      },
      "enabled": true,
      "priority": 95
    }
  ],

  "fallbackChain": {
    "id": "default-fallback",
    "entries": [
      {
        "provider": "claude",
        "models": ["claude-sonnet-4-20250514", "claude-3-5-haiku-20241022"],
        "enabled": true,
        "priority": 100,
        "maxAttempts": 2,
        "timeoutMs": 30000
      },
      {
        "provider": "openai",
        "models": ["gpt-4o", "gpt-4o-mini"],
        "enabled": true,
        "priority": 90,
        "maxAttempts": 2
      },
      {
        "provider": "ollama",
        "models": ["llama3.1", "mistral"],
        "enabled": true,
        "priority": 80,
        "maxAttempts": 2,
        "timeoutMs": 60000
      }
    ],
    "maxRetries": 3,
    "retryDelayMs": 100,
    "backoffMultiplier": 2,
    "maxDelayMs": 5000
  },

  "fallbackBehavior": {
    "maxAttempts": 3,
    "delayMs": 100,
    "trySameProviderAlternateModel": true,
    "skipOpenCircuits": true,
    "retryableErrors": [
      "RATE_LIMITED",
      "TIMEOUT",
      "NETWORK_ERROR",
      "PROVIDER_UNAVAILABLE"
    ]
  },

  "enableMetrics": true,
  "metricsConfig": {
    "enabled": true,
    "collectionIntervalMs": 60000,
    "retentionMs": 86400000,
    "trackPerRequest": true,
    "export": {
      "enabled": false,
      "endpoint": "http://localhost:9090/metrics",
      "format": "prometheus"
    }
  },

  "maxDecisionTimeMs": 10,
  "cacheDecisions": true,
  "decisionCacheTtlMs": 60000,

  "cacheConfig": {
    "enabled": true,
    "ttlMs": 60000,
    "maxEntries": 1000,
    "keyStrategy": "agent-domain"
  },

  "auditConfig": {
    "enabled": true,
    "maxEntries": 10000,
    "logContent": false,
    "logResponse": false,
    "export": {
      "enabled": false,
      "destination": "./logs/router-audit.jsonl"
    }
  },

  "costLimits": {
    "_comment": "Cost protection settings",
    "maxDailyCostUsd": 100,
    "maxRequestCostUsd": 1,
    "warnThresholdPercent": 80,
    "blockAtLimit": true
  }
}
